<div class="container-fluid py-4">

  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <h5 class="text-muted mb-1">Customer Dashboard</h5>
      <h2 class="mb-0">Your Shipments</h2>
      <small class="text-muted">
        Track status and amounts for your import / export orders
      </small>
    </div>

    <button class="btn btn-danger btn-sm" (click)="logout()">
      <i class="fa fa-sign-out me-1"></i> Logout
    </button>
  </div>

  <!-- KPI cards -->
  <div class="row g-3 mb-4">
  <div class="col-md-3" *ngFor="let card of kpiCards">
    <div class="card kpi-card shadow-sm h-100 border-0" [ngClass]="card.color">
      <div class="card-body">
        <div class="text-muted small mb-1">{{ card.title }}</div>

        <div class="d-flex justify-content-between align-items-end">
          <h3 class="mb-0 fw-semibold">{{ card.value }}</h3>
          <small class="trend" *ngIf="card.trend">{{ card.trend }}</small>
        </div>
      </div>
    </div>
  </div>
</div>


  <!-- Table + filters card -->
  <div class="card shadow-sm border-0">
    <div class="card-header bg-white">
      <div class="d-flex justify-content-between align-items-center">
        <h5 class="mb-0">Shipments</h5>
        <small class="text-muted">
          {{ dataSource.filteredData.length || 0 }} results
        </small>
      </div>
    </div>

    <!-- Filters -->
    <div class="card-body border-bottom bg-light">
      <div class="row g-2 align-items-end">
        <div class="col-md-4">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Search</mat-label>
            <input matInput
                   (keyup)="applyTextFilter($event)"
                   placeholder="Product / country">
          </mat-form-field>
        </div>

        <div class="col-md-3">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Status</mat-label>
            <mat-select [(value)]="filter.status" (selectionChange)="onStatusChange()">
              <mat-option value="">All</mat-option>
              <mat-option value="Booked">Booked</mat-option>
              <mat-option value="In Transit">In Transit</mat-option>
              <mat-option value="Delivered">Delivered</mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div class="col-md-3">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Country</mat-label>
            <mat-select [(value)]="filter.country" (selectionChange)="onCountryChange()">
              <mat-option value="">All</mat-option>
              <mat-option *ngFor="let c of countries" [value]="c">{{ c }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
    </div>

    <!-- Table -->
    <div class="card-body p-0">
      <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z1 w-100">

        <!-- Product -->
        <ng-container matColumnDef="product">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Product </th>
          <td mat-cell *matCellDef="let element"> {{ element.product }} </td>
        </ng-container>

        <!-- Country -->
        <ng-container matColumnDef="country">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Country </th>
          <td mat-cell *matCellDef="let element"> {{ element.country }} </td>
        </ng-container>

        <!-- Amount -->
        <ng-container matColumnDef="amount">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Amount </th>
          <td mat-cell *matCellDef="let element"> {{ element.amount | number }} </td>
        </ng-container>

        <!-- Status -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Status </th>
          <td mat-cell *matCellDef="let element">
            <span class="badge"
                  [ngClass]="{
                    'bg-secondary': element.status === 'Booked',
                    'bg-info': element.status === 'In Transit',
                    'bg-success': element.status === 'Delivered'
                  }">
              {{ element.status }}
            </span>
          </td>
        </ng-container>

        <!-- Date -->
        <ng-container matColumnDef="date">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Shipment Date </th>
          <td mat-cell *matCellDef="let element">
            {{ element.date | date:'dd MMM yyyy' }}
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

      </table>
    </div>

    <!-- Paginator -->
    <div class="card-footer bg-white d-flex justify-content-end">
      <mat-paginator [pageSizeOptions]="[5, 10, 25]" showFirstLastButtons></mat-paginator>
    </div>
  </div>

</div>
